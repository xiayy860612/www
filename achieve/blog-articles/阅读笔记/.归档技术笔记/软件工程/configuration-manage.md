# 项目中的配置管理

一个项目中的配置往往分布于工作流的不同阶段, 一般有以下几个阶段:

- 开发阶段
- 编译阶段
- 部署阶段
- 运行阶段

针对每个阶段的配置的作用以及管理策略往往不尽相同, 后面我们会对每个阶段一一描述.

## 开发阶段的配置管理

开发阶段的配置为了保证在一定指标的软硬件环境下, 开发人员能够在**本地**运行, 测试和调试程序, 
主要涉及以下几个方面:

- 代码中的业务逻辑相关的配置管理
- 本地开发运行的配置管理

关于代码中的配置主要是为了保证代码的可维护性, 主要指:

- 统一管理各种magic code, 枚举等静态常量, 避免在业务逻辑中直接使用magic code

- 包含**标准软硬件环境要求**下的功能配置
- 本地运行时的外部依赖服务的配置

## 编译阶段的配置管理

编译阶段的配置用来保证能够生成一个**正确**的**功能齐全**的程序包

**正确**指的以下几个方面:

- 正确的程序语言的版本
- 相关依赖包的完整列表以及正确的依赖包版本
- 正确的程序包的版本
- 正确的编译期工具的版本

**功能齐全**指的以下几个方面:

- 包含发布版本要求的所有功能
- 所有功能都经过**比较全面**的测试, 保证**功能的正确性**

相关语言, 依赖包, 工具等的版本通常使用**构建工具**来进行维护, 例如maven, gradle, npm等.

通过**版本管理工具(Version Control System)的分支管理**来保证发布分支包含要发布的所有功能代码

## 部署阶段的配置管理

部署阶段的配置是为了保证程序包能够在**具体的环境**中**正确的运行**.

部署阶段的配置涉及有:

- 基础设施环境的配置管理, 包括调优配置等, 如nginx, mysql等
- 各种相关的敏感信息的配置, 如密码, 密钥等等
- 外部依赖服务的集成配置, 例如mysql, redis, 第三方服务等.
- 根据不同的软硬件环境, 对标配的功能配置进行调整, 更好的使用软硬件的性能

基础设施环境的配置一般使用**版本管理工具(Version Control System)**对其进行管理, 方便重建环境.

关于敏感信息的配置管理, 一般使用**版本管理工具(Version Control System)**对其单独进行管理, 
详细内容可参考ThoughtWorks曾星鑫的源代码中的敏感信息管理一文.

外部依赖服务的集成配置以及不同环境的功能配置, 往往配置在自动化工具中, 例如Jenkins, Bamboo等, 
通过自动化流水线来替换和生成最终的部署功能配置.

## 运行阶段的配置管理

运行阶段的配置是为了保证对外开放合适版本的程序, 供用户使用.

运行阶段的配置涉及有:

- 网关的管理
- 限流

**TODO: 后面继续补充**